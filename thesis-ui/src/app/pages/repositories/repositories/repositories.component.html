<div class="w-100">
  <div class="row d-flex w-100 flex-row justify-content-end">
    <button nbButton outline status="primary" (click)="openAddRepositoryDialog()">Add</button>
  </div>

  <div class="row">
    <div class="col-md-4" *ngFor="let r of repositories">
      <nb-card>
        <nb-card-body>
          <div class="d-flex flex-row justify-content-between">
            <div class="d-flex flex-column">
              <div class="font-weight-bold h4 m-0">{{r.url | repoNameExtract}}</div>
              <div class="small">{{r.url}}</div>
              <div class="small">
                <img [src]="'images/branch_git.svg'" style="font-size: 10px">
              </div>
              <div class="font-weight-light">master - every 5 minutes</div>
            </div>
            <div>
              <nb-icon style="margin-top: 6px; font-size: 1.5rem"
                       [icon]="'settings-2-outline'" pack="eva"></nb-icon>
            </div>
          </div>

          <div class="w-100 mt-1" style="border-bottom: 1px solid gray"></div>

          <div class="d-flex pl-1 flex-row mt-4 justify-content-between">
            <ul>
              <li>
                <div class="h6 font-weight-bold">PYTHON_DEP</div>
              </li>
              <li>
                <div class="h6 font-weight-bold">DOCKERfILE_NMAP</div>
              </li>
            </ul>
          </div>

          <div class="d-flex flex-row mt-2 justify-content-center">
            <button (click)="repositoryDetails(r)" nbButton status="primary">Details</button>
          </div>
        </nb-card-body>
      </nb-card>
    </div>
  </div>
  <!--  <div class="row w-100">
      <nb-card class="inline-form-card w-100">
        <nb-card-header>Add new Moon Cloud Probes dependency to monitoring</nb-card-header>
        <nb-card-body>
          <form [formGroup]="newGitraceFormGroup" class="form-inline">

            <div class="col-md-1">
              <nb-select formControlName="gitProvider">
                <nb-option [value]="GitProvider.GITLAB">GITLAB</nb-option>
                <nb-option [value]="GitProvider.GITHUB">GITHUB</nb-option>
              </nb-select>
            </div>

            <div class="col-md-3">
              <input
                type="text"
                nbInput fullWidth
                class="form-control full-width"
                placeholder="Repository link"
                formControlName="gitRepoUrl"
                required>
              <div class="position-absolute text-danger small" *ngIf="newGitraceFormGroup.controls.gitRepoUrl.dirty &&
              newGitraceFormGroup.controls.gitRepoUrl.hasError('invalidUrl')">
                GIT url must end with .git extension
              </div>
            </div>

            <div class="col-md-2">
              <nb-select class="w-100" placeholder="Connection" formControlName="connectionId">
                <nb-option [value]="null">None</nb-option>
                <nb-option *ngFor="let c of connections" [value]="c.id">{{c.name}}</nb-option>
              </nb-select>
            </div>

            <div class="col-md-3">
              <input
                type="text"
                nbInput fullWidth
                class="form-control"
                placeholder="Description"
                formControlName="gitDescription">
            </div>

            <div class="col-md-2">
              <button
                type="submit"
                nbButton
                status="primary"
                (click)="createNewGitrace()"
                [disabled]="newGitraceFormGroup.invalid || pendingRequest">Create
              </button>
            </div>
          </form>
        </nb-card-body>
      </nb-card>
    </div>
    <div class="row w-100 mt-2">
      <nb-card class="w-100">
        <nb-card-body>
          <ng2-smart-table [settings]="settings" [source]="source">
          </ng2-smart-table>
        </nb-card-body>
      </nb-card>
    </div>-->
</div>

{{repositories  |json}}
<ng-template #addRepositoryDialog>
  <div class="add-repository w-100">
    <nb-card>
      <div class="modal-header">Add repository</div>
      <div class="modal-body">
        <form [formGroup]="newRepositoryFormGroup" class="form-inline">

          <div class="row w-100 d-flex flex-row">
            <div class="col-9">
              <input
                type="text"
                nbInput fullWidth
                class="form-control"
                placeholder="Repository URL"
                formControlName="url">
            </div>
            <div class="col-3">
              <input
                type="text"
                nbInput fullWidth
                class="form-control"
                placeholder="Repository branch"
                formControlName="branch">
            </div>
          </div>

          <div class="row w-100 d-flex flex-row">
            <div class="col-4">
              <input
                type="text"
                nbInput fullWidth
                class="form-control"
                placeholder="Username"
                formControlName="username">
            </div>

            <div class="col-5">
              <input
                type="password"
                nbInput fullWidth
                class="form-control"
                placeholder="Password"
                formControlName="password">
            </div>

            <div class="col-3">
              <input
                type="number"
                [min]="5"
                nbInput fullWidth
                class="form-control"
                placeholder="Interval"
                formControlName="minutesWatchersInterval">
            </div>

          </div>

          <div class="row w-100 d-flex flex-row">
            <div class="col-12">
              <div style="height: 300px">
                <ngx-monaco-editor formControlName="recipe" style="height: 100%"
                                   [options]="editorOptions"></ngx-monaco-editor>
              </div>
            </div>
          </div>

        </form>
      </div>
      <div class="modal-footer">
        <div class="w-100 d-flex flex-row justify-content-end">
          <button nbButton status="basic" class="btn-outline-secondary mr-2" (click)="closeDialog()">Cancel</button>
          <button [disabled]="newRepositoryFormGroup.invalid" nbButton status="primary" (click)="createNewRepository()">
            Create
          </button>
        </div>
      </div>
    </nb-card>
  </div>
</ng-template>
